# S2_get_beta_diversity

This folder contains scripts and data necessary for estimating beta diversity, both taxonomic and functional. The workflow is designed to process datasets in sequence, leveraging pre-processed data and functional dissimilarity matrices to compute beta diversity.

------------------------------------------------------------------------

## Workflow Description

### Step 1: Functional Dissimilarity Calculation

**Script:** `Scripts/1-get_functional_dissimilarities.R`\
- This script calculates functional dissimilarity between species using the `gawdis` function.\
- The results are saved in the `betadiv_input/` folder as `.rds` files, which are required for the next step.

**Usage:** 1. Run this script on your local machine or HPC using `Scripts/run_gawdis.sh`. 2. Ensure all pre-processed data files are available in the `pre_processed/` folder.

------------------------------------------------------------------------

### Step 2: Beta Diversity Estimation

**Script:** `Scripts/2-get_beta_diversity.R`\
- This script computes taxonomic beta diversity (using the `BAT` package) and functional beta diversity (using the `hypervolume` package). - It reads functional dissimilarity files from `betadiv_input/` and generates beta diversity results in `betadiv_output/`.

**Usage:** 1. Ensure `betadiv_input/` is populated with outputs from Step 1. 2. Run this script using `Scripts/run_betadiv.sh`.

------------------------------------------------------------------------

## Input and Output

### Input Files

-   **Functional Dissimilarity Matrices:** Located in `betadiv_input/`, these files are generated by `Scripts/1-get_functional_dissimilarities.R`.
-   **Pre-processed Data:** Located in `pre_processed/`, these files come from Step 1 of the pipeline.

### Output Files

-   **Beta Diversity Results:** Saved in `betadiv_output/` as `{dataset_name}_beta_Output.rds`.

------------------------------------------------------------------------

## Execution on HPC

### Functional Dissimilarity

-   Use the `Scripts/run_gawdis.sh` script to execute `Scripts/1-get_functional_dissimilarities.R` on multiple datasets in parallel.

### Beta Diversity

-   Use the `Scripts/run_betadiv.sh` script to execute `Scripts/2-get_beta_diversity.R` on multiple datasets in parallel.

------------------------------------------------------------------------

## Notes

1.  **Dependency:** `Scripts/2-get_beta_diversity.R` depends on outputs from `Scripts/1-get_functional_dissimilarities.R`.
2.  **Parallel Processing:** Both scripts are optimized for HPC execution and support parallel processing.
3.  **Error Handling:** Ensure all required packages (`gawdis`, `BAT`, `hypervolume`, etc.) are installed before running the scripts.

------------------------------------------------------------------------
